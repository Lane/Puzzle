<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">

        <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
				
				<link href="css/tyrannosaurus.css" rel="stylesheet" />
				
				<script src="js/libs/modernizr-2.6.2.min.js"></script>
        <script src="http://code.createjs.com/createjs-2013.02.12.min.js" type="text/javascript"></script>
        <script src="http://code.createjs.com/preloadjs-0.3.0.min.js" type="text/javascript"></script>
        <script src="js/vendor/easeljs/filters/ColorFilter.js"></script>
        <script src="js/libs/ba-debug.js"></script>
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
        <![endif]-->

      	<div id="loader" style="display:none"></div>
      
      	<div id="fullscreen" class="canvasHolder">
      		<canvas id="puzzleCanvas" width="878" height="494"></canvas>
      		<div id="interface">
      			<h1>Build a Tyrannosaurus</h1>
      			<div class="welcome-body">
	      			<img id="instructions" src="assets/tyrannosaurus/instructions.gif" />
	      			<p>
	      				The following screen contains an interactive 2D puzzle.  The hips of the Tyrannosaurus are already in place, move and rotate the other pieces of the puzzle into place to rebuild the Tyrannosaurus. 
	      			</p>
      			</div>
      			<div id="loader"> 
      			
      				<div id="progress-bar"></div>
      			
      			</div>
      			<div class="action-row">
      				<a id="help" href="#" class="btn btn-help">?</a>
      				<a id="start" href="#" class="btn btn-start btn-disabled">Loading</a>
      			</div>
      		</div>
      	</div>

        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="js/libs/jquery-1.9.0.min.js"><\/script>')</script>
        <script src="js/utils.js"></script>
        <script src="js/Objects/Event.js"></script>
        <script src="js/Objects/Boundary.js"></script>
        <script src="js/Objects/PieceContainer.js"></script>
        <script src="js/Objects/Piece.js"></script>
        <script src="js/Objects/Point.js"></script>
        <script src="js/Objects/RotateHandle.js"></script>
        <script src="js/Model/Puzzle.js"></script>
        <script src="js/View/PuzzleView.js"></script>
        <script src="js/Controller/PuzzleController.js"></script>        
        <script src="js/PuzzleBuilder.js"></script>
        <script>
       			var puzzle;
       			
       			var pfx = ["webkit", "moz", "ms", "o", ""];
       			function RunPrefixMethod(obj, method) {
       				var p = 0, m, t;
       				while (p < pfx.length && !obj[m]) {
       					m = method;
       					if (pfx[p] == "") {
       						m = m.substr(0,1).toLowerCase() + m.substr(1);
       					}
       					m = pfx[p] + m;
       					t = typeof obj[m];
       					if (t != "undefined") {
       						pfx = [pfx[p]];
       						return (t == "function" ? obj[m]() : obj[m]);
       					}
       					p++;
       				}
       			}
       			
       			
       			

       			
       			
       			debug.setLevel(0);
       			//var debugPoints = true;
       			
        		$(document).ready(function() {
      
        			var TestPuzzle = {
        				background: { id : "background", src : "assets/layout_grid.gif" },
        				pieces: [
        					{ id: "300x100", src: "assets/test/300x100.png" },
        					{ id: "100x300", src: "assets/test/100x300.png" },
        					{ id: "200x200", src: "assets/test/200x200.png" },
        					{ id: "100x100", src: "assets/test/100x100.png" }
        				],
        				matches: [
        					[ 
        						{ piece: "300x100", x: -150, y: 0 		}, 	
        						{ piece: "100x300", x: -50, 	y: -150 } 
        					],
        					[ 
        						{ piece: "300x100", x: 150, 	y: 0		}, 	
        						{ piece: "200x200", x: 0, 		y: -100	} 
        					],
        					[ 
        						{ piece: "100x300", x: 50, 	y: -150		}, 	
        						{ piece: "100x100", x: 0, 		y: 50		} 
        					],
        					[ 
        						{ piece: "200x200", x: 0, 		y: 100	}, 	
        						{ piece: "100x100", x: 0, 		y: -50	} 
        					]
        				]
        			};
        			
        			var HorsePuzzle = {
        				background: { id : "background", src : "assets/layout_grid.gif" },
        				pieces: [
        					{ id: "head", src: "assets/horse/head.png" },
        					{ id: "back-legs", src: "assets/horse/back-legs.png" },
        					{ id: "front-legs", src: "assets/horse/front-legs.png" },
        					{ id: "back", src: "assets/horse/back.png" }
        				],
        				matches: [
        					[ 
        						{ piece: "head", x: -135, y: 60 	}, 	
        						{ piece: "back", x: 240, 	y: -80 	} 
        					],
        					[ 
        						{ piece: "front-legs", x: -25, 	y: -164	}, 	
        						{ piece: "back", 			 x: 200, 	y: 85		} 
        					],
        					[ 
        						{ piece: "back-legs", x: 80, 		y: -225	}, 	
        						{ piece: "back", 			x: -88, 	y: -70	} 
        					]
        				]
        			};
        			
        			var DinoPuzzle = {
        				background: { id : "background", src : "assets/tyrannosaurus/background.jpg" },
        				pieces: [
        					{ id: "arm", src: "assets/tyrannosaurus/arm.png" },
        					{ id: "back-ribs", src: "assets/tyrannosaurus/back-ribs.png" },
        					{ id: "belly-ribs", src: "assets/tyrannosaurus/belly-ribs.png" },
        					{ id: "hips", src: "assets/tyrannosaurus/hips.png", fixed: true, x:400, y:200 },
        					{ id: "leg", src: "assets/tyrannosaurus/leg.png" },
        					{ id: "neck", src: "assets/tyrannosaurus/neck.png" },
        					{ id: "skull", src: "assets/tyrannosaurus/skull.png" },
        					{ id: "tail", src: "assets/tyrannosaurus/tail.png" },
        				],
        				matches: [
        					[ 
        						{ piece: "skull", x: 45, y: -45 	}, 	
        						{ piece: "neck", x: -39, 	y: -16 	} 
        					],
        					[ 
        						{ piece: "neck", x: 32, y: 18 	}, 	
        						{ piece: "back-ribs", x: -80, 	y: -25 	} 
        					],
        					[ 
        						{ piece: "back-ribs", x: -25, y: -35 	}, 	
        						{ piece: "arm", x: 25, 	y: -60 	} 
        					],
        					[ 
        						{ piece: "back-ribs", x: 75, y: -28 	}, 	
        						{ piece: "hips", x: -51, y: -50  	} 
        					],
        					[ 
        						{ piece: "hips", x: 2, y: -32 	}, 	
        						{ piece: "leg", x: -60, y: -120  	} 
        					],
        					[ 
        						{ piece: "hips", x: -70, y: 67 	}, 	
        						{ piece: "belly-ribs", x: 60, y: 25  	} 
        					],
        					[ 
        						{ piece: "hips", x: 55, y: -40 	}, 	
        						{ piece: "tail", x: -185, y: -10  	} 
        					]
        				]
        			};
        			
        			var loader = new PuzzleBuilder();
        			
        			var welcomeScreen = document.getElementById("interface");
        			var progressBar = document.getElementById("progress-bar");
        			var startButton = document.getElementById("start");
        			
        			loader.loadPuzzle(DinoPuzzle);
        			
        			loader.progressChange.attach(function(sender,args) {
        				var e = args.event;
        				var amountLoaded = Math.round(e.loaded*100);
        				progressBar.style.width = amountLoaded+"%";
        			});
        			
        			loader.puzzleLoaded.attach(function(sender,args) {
        				startButton.innerText = "Get Started";
        				startButton.className = "btn btn-start btn-enabled";
        			});
        			
        			startButton.onclick = function(event) {
        				welcomeScreen.className = "started";
        			};
        			
        			puzzle = loader.puzzle;
        			
        			/*
        			var e = document.getElementById("toggle");
        			
        			e.onclick = function() {
	        			if (RunPrefixMethod(document, "FullScreen") || RunPrefixMethod(document, "IsFullScreen")) {
	        				RunPrefixMethod(document, "CancelFullScreen");
	        			}
	        			else {
	        				RunPrefixMethod(document.getElementById("puzzleCanvas"), "RequestFullScreen");
	        			}
							}
							*/
        		});
        		
      		
        </script>
    </body>
</html>
